<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="../dist/mobile-text-selection.umd.js"></script>
  </head>
  <style>
    * {
      box-sizing: border-box;
    }
    html,
    body,
    #container {
      position: relative;
      background-color: #f5f5f5;
    }
    body {
      padding-top: 30px;
    }
  </style>
  <body>
    <div
      id="container"
      style="
        background-color: blanchedalmond;
        margin: 10px 20px;
        padding-top: 8px;
        padding-left: 8px;
      "
    >
      既然如何， 既然如此， 一般来讲，我们都必须务必慎重的考虑考虑。
      我们不得不面对一个非常尴尬的事实，那就是，
      可是，即使是这样，中午吃什么的出现仍然代表了一定的意义。
      在这种困难的抉择下，本人思来想去，寝食难安。
      可是，即使是这样，中午吃什么的出现仍然代表了一定的意义。 这样看来，
      中午吃什么，发生了会如何，不发生又会如何。
      马尔顿说过一句富有哲理的话，坚强的信心，能使平凡的人做出惊人的事业。带着这句话，我们还要更加慎重的审视这个问题：
      从这个角度来看， 要想清楚，中午吃什么，到底是一种怎么样的存在。
      问题的关键究竟为何？
      中午吃什么的发生，到底需要如何做到，不中午吃什么的发生，又会如何产生。
      带着这些问题，我们来审视一下中午吃什么。 问题的关键究竟为何？
      所谓中午吃什么，关键是中午吃什么需要如何写。 从这个角度来看，
      亚伯拉罕·林肯曾经提到过，你活了多少岁不算什么，重要的是你是如何度过这些岁月的。带着这句话，我们还要更加慎重的审视这个问题：
      可是，即使是这样，中午吃什么的出现仍然代表了一定的意义。 既然如此，
      既然如此， 要想清楚，中午吃什么，到底是一种怎么样的存在。
      我们都知道，只要有意义，那么就必须慎重考虑。 一般来说，
      本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。
      中午吃什么，发生了会如何，不发生又会如何。
      中午吃什么的发生，到底需要如何做到，不中午吃什么的发生，又会如何产生。
      了解清楚中午吃什么到底是一种怎么样的存在，是解决一切问题的关键。
      现在，解决中午吃什么的问题，是非常非常重要的。 所以，
      所谓中午吃什么，关键是中午吃什么需要如何写。
      这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。
      一般来讲，我们都必须务必慎重的考虑考虑。
      中午吃什么的发生，到底需要如何做到，不中午吃什么的发生，又会如何产生。
      培根说过一句富有哲理的话，要知道对好事的称颂过于夸大，也会招来人们的反感轻蔑和嫉妒。带着这句话，我们还要更加慎重的审视这个问题：
      老子在不经意间这样说过，知人者智，自知者明。胜人者有力，自胜者强。我希望诸位也能好好地体会这句话。
      笛卡儿曾经说过，读一切好书，就是和许多高尚的人谈话。这句话语虽然很短，但令我浮想联翩。
      中午吃什么，到底应该如何实现。
      冯学峰曾经说过，当一个人用工作去迎接光明，光明很快就会来照耀着他。带着这句话，我们还要更加慎重的审视这个问题：
      我们都知道，只要有意义，那么就必须慎重考虑。
      中午吃什么的发生，到底需要如何做到，不中午吃什么的发生，又会如何产生。
      这样看来，
      乌申斯基说过一句富有哲理的话，学习是劳动，是充满思想的劳动。这启发了我，
      既然如何， 而这些并不是完全重要，更加重要的问题是，
      中午吃什么的发生，到底需要如何做到，不中午吃什么的发生，又会如何产生。
      拿破仑·希尔在不经意间这样说过，不要等待，时机永远不会恰到好处。带着这句话，我们还要更加慎重的审视这个问题。
    </div>
  </body>
</html>
<!-- 引入esm的话要用这段
<script type="module">
  import TextSelection from "../dist/mobile-text-selection.esm.js"
  new TextSelection(...)
</script> -->
<script>
  // 选中的文字
  let selectedText = "";
  // 实例 用于销毁等操作
  let textSelection;
  // 自定义游标
  const customDom = document.createElement("div");
  customDom.style.backgroundColor = "#1788bd";
  customDom.style.borderRadius = "0 50% 50% 50%";
  customDom.style.width = "30px";
  customDom.style.height = "30px";

  // 初始化
  window.onload = function () {
    const containerDomId = "container"; // TODO: 这个可以传元素id
    const container = containerDomId
      ? document.getElementById(containerDomId)
      : document.body;
    const img = new Image();
    img.src = "http://iph.href.lu/50x50?bg=ff0000";
    const TextSelection = window.TextSelection;
    textSelection = new TextSelection({
      container: container, // 必须要传哦
      cursorDom: customDom, // 自定义游标dom(右侧) 可以不传 传了这个则cursorColor失效
      cursorColor: "#1788bd", // 左右指针颜色 可以不传  "red" || "#333333" || "rgba(125,125,125, 0.5)"
      rectsColor: "rgba(23,136,189,0.35)", // 选中文字的颜色 可以不传    "#333333aa" || "rgba(125,125,125, 0.5)" 需要是个透明色哦
      longTapDuration: 600, // 长按的时间 可以不传 默认是600
      magnifierWidth: 100, // 放大镜宽度 可以不传 默认100px
      magnifierHeight: 50, // 放大镜高度 可以不传 默认50px
      magnifierOffset: 50, // 放大镜向上偏移的距离 可以不传 默认50px
      magnifierBackgroundColor: "#fff", // 放大镜背景色 可以不传 默认和container背景一样
      menu: [ // 菜单 可以不传 默认是[]
        {
          key: "copy", // 必须要传
          icon: img.cloneNode(), // 图片dom 可以不传 默认没有
          text: "复制", // 文本
          click: (params) => { // 回调 params: {text: string}
            alert(`点击了复制: ${JSON.stringify(params)}`);
          },
        },
        {
          key: "search",
          icon: img.cloneNode(),
          text: "查询",
          click: (params) => {
            alert(`点击了查询: ${JSON.stringify(params)}`);
          },
        },
      ],
      menuColor: "#ffffff", // 菜单文字颜色 可以不传 默认#ffffff
      menuBackgroundColor: "#000000", // 菜单背景色 可以不传 默认#000000
      onStart: () => {
        console.log("***onStart*** 开始选择:正在长按或正在移动游标");
      }, // 开始选择的回调 可以不传
      onCancel: () => {
        console.log("**onCancel*** 结束选择");
      }, // 失焦的回调 可以不传
      onFinish: ({ text, startX, startY, endX, endY }) => {
        console.log(
          "***onFinish*** 回调文字和坐标(相对于container)",
          text,
          "start: (",
          startX,
          ",",
          startY,
          ") end:(",
          endX,
          ",",
          endY,
          ")"
        );
        // 如果选到了符号 可以直接取消选中
        if(/^[`~!@#$^&*()=|{}':;',\[\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？’ \s]+$/.test(text)) {
          textSelection.blur();
        }
      }, // 选完的回调 也可以不传
      tokenizer: (str, index) => {
        // console.log("***tokenizer*** 需要分词的文字:", str, "文字长度:", str.length);
        // console.log("***tokenizer*** 需要分词的文字索引:", index);
        // console.log("***tokenizer*** 需要返回分词起始位置和长度");
        return [index, 1];
      },
    });
    // 初始化
    textSelection.init();
  };
  function del() {
    textSelection.destroy();
  }
</script>
