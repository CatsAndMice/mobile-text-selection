<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <script src="../dist/mobile-text-selection.umd.js"></script>
</head>
<style>
  * {
    box-sizing: border-box;
  }

  html,
  body,
  #container {
    position: relative;
    background-color: #f5f5f5;
  }

  body {
    padding-top: 30px;
  }
</style>

<body>
  <div class="tiptap ProseMirror" contenteditable="false" spellcheck="false" translate="no">
    <h2>今日工作</h2>
    <h2>一、本周重点工作</h2>
    <h3>1<span class="tip-comment" data-comment-id="100000000002639">、本周工作简要回顾&nbsp;&nbsp;</span></h3>
    <div class="tableWrapper">
      <div class="tableHoldbefore"></div>
      <div class="tableHold">
        <table style="width: 1120px;">
          <colgroup>
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
          </colgroup>
          <tbody>
            <tr>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center"><strong><span>项目/专项</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center"><strong><span>上周计划交付内容</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><strong><span>本周交付内容</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center"><strong><span>目标进度</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center"><strong><span>当前进度</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><strong><span>进度说明</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><strong><span>风险点和反馈</span></strong></p>
              </td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center">晶鱼</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><span class="tip-comment" data-comment-id="100000000002712">晶鱼V1.15.3需求测试</span></p>
                <p>上线内容：</p>
                <p><span>1.任务模块通用接口（晶鱼对外开放功能）</span></p>
                <p><span>2.晶鱼任务数据可导出excel</span></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>1.V1.15.3需求测试点编写已完成</p>
                <p>2.V1.15.3需求测试</p>
                <p>本周测试任务数据导出，晶鱼对外开放功能下周提测</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>100%</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>100%</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>任务数据导出测试已完成</p>
                <p>下周测试晶鱼对外开放功能</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><br class="ProseMirror-trailingBreak"></p>
                <p><span>无</span></p>
              </td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center">晶点</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>参与晶点接入晶品运营平台评审会议</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>参与晶点接入晶品运营平台评审会议</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>100%</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>100%</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>已完成</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>无</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="tableHoldafter showHold"></div>
    </div>
    <h3>2、重点成果展示</h3>
    <p>晶鱼V1.15.3测试点（重新截图）</p>
    <p>
    <div data-v-1c5b685e="" class="image-view image-view--block" data-node-view-wrapper="" contenteditable="false"
      draggable="true" style="white-space: normal;">
      <div data-v-1c5b685e="" class="image-view__body"><img data-v-1c5b685e="" contenteditable="false" draggable="false"
          src="https://ywja-public-bucket.oss-cn-hangzhou.aliyuncs.com/basic/trasfer/1714272729410/5eecdaf48460cde58ada7f405473473ee20ad4a946002333bf7c3b308096c3f27f71f2e4cb9f1c1939e8703ac5556d0d4ca733db4a023d6a66d9109cbee3da2035ad78a90aa7d8375715c9295643a51c3662a33579d16de1927b518753ac774c"
          data-comment-ids="" class="image-view__body__image">
        <div data-v-1c5b685e="" class="hover-btn"><span data-v-1c5b685e="" class="btn">添加批注</span><span
            data-v-1c5b685e=""
            style="background-color: rgba(0, 0, 0, 0.25); height: 24px; width: 1px; display: inline-block;"></span><span
            data-v-1c5b685e="" class="btn">创建任务</span></div>
        <div data-v-1c5b685e="" class="annotation-icon" style="display: none;"><svg data-v-1c5b685e="" width="20"
            height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g data-v-1c5b685e="" id="interactive-button/message">
              <path data-v-1c5b685e="" id="Vector" fill-rule="evenodd" clip-rule="evenodd"
                d="M1.66669 9.99999C1.66669 5.39762 5.39765 1.66666 10 1.66666C14.6024 1.66666 18.3334 5.39762 18.3334 9.99999V10.2761C18.3334 14.726 14.726 18.3333 10.2762 18.3333H1.66669V9.99999Z"
                fill="#0576FF"></path>
              <circle data-v-1c5b685e="" id="Ellipse 27" cx="5.83337" cy="10" r="1.25" fill="white"></circle>
              <circle data-v-1c5b685e="" id="Ellipse 28" cx="10" cy="10" r="1.25" fill="white"></circle>
              <circle data-v-1c5b685e="" id="Ellipse 29" cx="14.1667" cy="10" r="1.25" fill="white"></circle>
            </g>
          </svg></div><!---->
        <div data-v-1c5b685e="" class="image-view__body__placeholder el-tooltip__trigger el-tooltip__trigger"></div>
        <!--teleport start--><!--teleport end--><!---->
      </div>
    </div><img class="ProseMirror-separator" alt=""><br class="ProseMirror-trailingBreak"></p>
    <p>V1.15.3需求提报bug</p>
    <p>
    <div data-v-1c5b685e="" class="image-view image-view--block" data-node-view-wrapper="" contenteditable="false"
      draggable="true" style="white-space: normal;">
      <div data-v-1c5b685e="" class="image-view__body"><img data-v-1c5b685e="" contenteditable="false" draggable="false"
          src="https://ywja-public-bucket.oss-cn-hangzhou.aliyuncs.com/basic/trasfer/1714272729451/5eecdaf48460cde58ada7f405473473ee20ad4a946002333bf7c3b308096c3f27f71f2e4cb9f1c1939e8703ac5556d0d8c83c52a060c2174e7ebf7343b5b1c640f7845eda5daa893e654d274893f317b895cca8bb70d7c815997ac97f376514a"
          data-comment-ids="" class="image-view__body__image">
        <div data-v-1c5b685e="" class="hover-btn"><span data-v-1c5b685e="" class="btn">添加批注</span><span
            data-v-1c5b685e=""
            style="background-color: rgba(0, 0, 0, 0.25); height: 24px; width: 1px; display: inline-block;"></span><span
            data-v-1c5b685e="" class="btn">创建任务</span></div>
        <div data-v-1c5b685e="" class="annotation-icon" style="display: none;"><svg data-v-1c5b685e="" width="20"
            height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g data-v-1c5b685e="" id="interactive-button/message">
              <path data-v-1c5b685e="" id="Vector" fill-rule="evenodd" clip-rule="evenodd"
                d="M1.66669 9.99999C1.66669 5.39762 5.39765 1.66666 10 1.66666C14.6024 1.66666 18.3334 5.39762 18.3334 9.99999V10.2761C18.3334 14.726 14.726 18.3333 10.2762 18.3333H1.66669V9.99999Z"
                fill="#0576FF"></path>
              <circle data-v-1c5b685e="" id="Ellipse 27" cx="5.83337" cy="10" r="1.25" fill="white"></circle>
              <circle data-v-1c5b685e="" id="Ellipse 28" cx="10" cy="10" r="1.25" fill="white"></circle>
              <circle data-v-1c5b685e="" id="Ellipse 29" cx="14.1667" cy="10" r="1.25" fill="white"></circle>
            </g>
          </svg></div><!---->
        <div data-v-1c5b685e="" class="image-view__body__placeholder el-tooltip__trigger el-tooltip__trigger"></div>
        <!--teleport start--><!--teleport end--><!---->
      </div>
    </div><img class="ProseMirror-separator" alt=""><br class="ProseMirror-trailingBreak"></p>
    <h3>3、不足和反思</h3>
    <p>本周出现严重bug，为移动端创建任务不能添加负责人，为上个版本发版未涉及到的功能影响从而出现的故障</p>
    <p>反思：对于主流程功能做好回归，对于版本未涉及到的功能，但有影响的功能要多考虑，做好回归测试</p>
    <h2>二、下周重点工作计划</h2>
    <div class="tableWrapper">
      <div class="tableHoldbefore"></div>
      <div class="tableHold">
        <table style="width: 800px;">
          <colgroup>
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
            <col style="width: 160px;">
          </colgroup>
          <tbody>
            <tr>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center"><strong><span>项目/专项</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><strong><span>下周计划交付内容</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center"><strong><span>目标进度</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><strong><span>进度说明</span></strong></p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><strong><span>风险点和反馈</span></strong></p>
              </td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p style="text-align: center">晶鱼</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>晶鱼V1.15.3需求测试上线</p>
                <p>测试内容：</p>
                <p>a.任务模块通用接口（晶鱼外部开放功能需求）</p>
                <p>b.任务数据导出</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>100%</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p>预计4月29号上线</p>
              </td>
              <td colspan="1" rowspan="1" colwidth="160" style="">
                <p><br class="ProseMirror-trailingBreak"></p>
                <p><span>暂无</span></p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="tableHoldafter"></div>
    </div>
    <h2>三、重点关注或协调事项&nbsp;/本周BUG跟进</h2>
    <h3><strong><span>Bug跟进：</span></strong></h3>
    <ol>
      <li>
        <p>移动端创建任务不能添加负责人（已解决上线）</p>
      </li>
      <li>
        <p>移动端链接被批注功能覆盖，无法打开（已解决上线）</p>
      </li>
      <li>
        <p><span>简报批注未@对应人&nbsp;，对应人也会有收到@通知（已解决发布在测试环境已验证，未上线，计划下个版本上线）</span></p>
      </li>
    </ol>
    <p><br class="ProseMirror-trailingBreak"></p>
  </div>
</body>

</html>
<!-- 引入esm的话要用这段
<script type="module">
  import TextSelection from "../dist/mobile-text-selection.esm.js"
  new TextSelection(...)
</script> -->
<script>
  // 选中的文字
  let selectedText = "";
  // 实例 用于销毁等操作
  let textSelection;
  // 自定义游标
  const customDom = document.createElement("div");
  customDom.style.backgroundColor = "#1788bd";
  customDom.style.borderRadius = "0 50% 50% 50%";
  customDom.style.width = "30px";
  customDom.style.height = "30px";

  // 初始化
  window.onload = function () {
    const containerDomId = "container"; // TODO: 这个可以传元素id
    const container = containerDomId
      ? document.getElementById(containerDomId)
      : document.body;
    const img = new Image();
    img.src = "http://iph.href.lu/50x50?bg=ff0000";
    const TextSelection = window.TextSelection;
    textSelection = new TextSelection({
      container: container, // 必须要传哦
      cursorDom: customDom, // 自定义游标dom(右侧) 可以不传 传了这个则cursorColor失效
      cursorColor: "#1788bd", // 左右指针颜色 可以不传  "red" || "#333333" || "rgba(125,125,125, 0.5)"
      rectsColor: "rgba(23,136,189,0.35)", // 选中文字的颜色 可以不传    "#333333aa" || "rgba(125,125,125, 0.5)" 需要是个透明色哦
      longTapDuration: 600, // 长按的时间 可以不传 默认是600
      magnifierWidth: 100, // 放大镜宽度 可以不传 默认100px
      magnifierHeight: 50, // 放大镜高度 可以不传 默认50px
      magnifierOffset: 50, // 放大镜向上偏移的距离 可以不传 默认50px
      magnifierBackgroundColor: "#fff", // 放大镜背景色 可以不传 默认和container背景一样
      menu: [ // 菜单 可以不传 默认是[]
        {
          key: "copy", // 必须要传
          icon: img.cloneNode(), // 图片dom 可以不传 默认没有
          text: "复制", // 文本
          click: (params) => { // 回调 params: {text: string}
            alert(`点击了复制: ${JSON.stringify(params)}`);
          },
        },
        {
          key: "search",
          icon: img.cloneNode(),
          text: "查询",
          click: (params) => {
            alert(`点击了查询: ${JSON.stringify(params)}`);
          },
        },
      ],
      menuColor: "#ffffff", // 菜单文字颜色 可以不传 默认#ffffff
      menuBackgroundColor: "#000000", // 菜单背景色 可以不传 默认#000000
      onStart: () => {
        console.log("***onStart*** 开始选择:正在长按或正在移动游标");
      }, // 开始选择的回调 可以不传
      onCancel: () => {
        console.log("**onCancel*** 结束选择");
      }, // 失焦的回调 可以不传
      onFinish: ({ text, startX, startY, endX, endY }) => {
        console.log(
          "***onFinish*** 回调文字和坐标(相对于container)",
          text,
          "start: (",
          startX,
          ",",
          startY,
          ") end:(",
          endX,
          ",",
          endY,
          ")"
        );
        // 如果选到了符号 可以直接取消选中
        if (/^[`~!@#$^&*()=|{}':;',\[\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？’ \s]+$/.test(text)) {
          textSelection.blur();
        }
      }, // 选完的回调 也可以不传
      tokenizer: (str, index) => {
        // console.log("***tokenizer*** 需要分词的文字:", str, "文字长度:", str.length);
        // console.log("***tokenizer*** 需要分词的文字索引:", index);
        // console.log("***tokenizer*** 需要返回分词起始位置和长度");
        return [index, 1];
      },
    });
    // 初始化
    textSelection.init();
  };
  function del() {
    textSelection.destroy();
  }
</script>